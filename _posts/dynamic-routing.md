---
title: "Reacté‚£äº›å¸¸ç”¨çš„hookæ˜¯å“ªäº›ï¼Ÿ"
excerpt: "ä¹Ÿè®¸ä½ ä¼šé—®ï¼Œä¸ºä»€ä¹ˆè¦å­¦è¿™äº›hookï¼Ÿè¿™äº›hookæœ‰ä»€ä¹ˆç”¨ï¼Ÿå®ƒä»¬çš„åº•å±‚åŸç†æ˜¯ä»€ä¹ˆï¼Ÿè¿™äº›é—®é¢˜éƒ½æ˜¯å€¼å¾—æ€è€ƒçš„ã€‚"
coverImage: "/assets/blog/dynamic-routing/cover.jpg"
date: "2020-03-16T05:35:07.322Z"
author:
  name: king.
  picture: "/assets/blog/authors/jj.jpeg"
ogImage:
  url: "/assets/blog/dynamic-routing/cover.jpg"
---
# ä¸€ã€å®šä¹‰

`useState` æ˜¯ä¸€ä¸ª React Hookï¼Œå®ƒå…è®¸ä½ å‘ç»„ä»¶æ·»åŠ ä¸€ä¸ª [çŠ¶æ€å˜é‡](https://zh-hans.react.dev/learn/state-a-components-memory)ã€‚


# äºŒã€ä½¿ç”¨

```javascript


const [state, setState] = useState(initialState)
```
### 1ã€å‚æ•°
`initialState`ï¼šä½ å¸Œæœ› state åˆå§‹åŒ–çš„å€¼ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†å¯¹äºå‡½æ•°æœ‰ç‰¹æ®Šçš„è¡Œä¸ºã€‚åœ¨åˆå§‹æ¸²æŸ“åï¼Œæ­¤å‚æ•°å°†è¢«å¿½ç•¥ã€‚

-   å¦‚æœä¼ é€’å‡½æ•°ä½œä¸ºÂ `initialState`ï¼Œåˆ™å®ƒå°†è¢«è§†ä¸ºÂ **åˆå§‹åŒ–å‡½æ•°**ã€‚å®ƒåº”è¯¥æ˜¯çº¯å‡½æ•°ï¼Œä¸åº”è¯¥æ¥å—ä»»ä½•å‚æ•°ï¼Œå¹¶ä¸”åº”è¯¥è¿”å›ä¸€ä¸ªä»»ä½•ç±»å‹çš„å€¼ã€‚å½“åˆå§‹åŒ–ç»„ä»¶æ—¶ï¼ŒReact å°†è°ƒç”¨ä½ çš„åˆå§‹åŒ–å‡½æ•°ï¼Œå¹¶å°†å…¶è¿”å›å€¼å­˜å‚¨ä¸ºåˆå§‹çŠ¶æ€ã€‚

### 2ã€è¿”å›

`useState` è¿”å›ä¸€ä¸ªç”±ä¸¤ä¸ªå€¼ç»„æˆçš„æ•°ç»„ï¼š

1.  å½“å‰çš„ stateã€‚åœ¨é¦–æ¬¡æ¸²æŸ“æ—¶ï¼Œå®ƒå°†ä¸ä½ ä¼ é€’çš„Â `initialState`Â ç›¸åŒ¹é…ã€‚
1.  [`set`Â å‡½æ•°](https://zh-hans.react.dev/reference/react/useState#setstate)ï¼Œå®ƒå¯ä»¥è®©ä½ å°† state æ›´æ–°ä¸ºä¸åŒçš„å€¼å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚
### 3ã€`set`Â å‡½æ•°
`useState` è¿”å›çš„ `set` å‡½æ•°å…è®¸ä½ å°† state æ›´æ–°ä¸ºä¸åŒçš„å€¼å¹¶è§¦å‘é‡æ–°æ¸²æŸ“ã€‚ä½ å¯ä»¥ç›´æ¥ä¼ é€’æ–°çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥ä¼ é€’ä¸€ä¸ªæ ¹æ®å…ˆå‰çŠ¶æ€æ¥è®¡ç®—æ–°çŠ¶æ€çš„å‡½æ•°ï¼š

```js
const [name, setName] = useState('Edward');



function handleClick() {

  setName('Taylor');

  setAge(a => a + 1);

  // ...
```

###### å‚æ•°Â [](https://zh-hans.react.dev/reference/react/useState#setstate-parameters "Link for å‚æ•° ")

-   `nextState`ï¼šä½ æƒ³è¦ state æ›´æ–°ä¸ºçš„å€¼ã€‚å®ƒå¯ä»¥æ˜¯ä»»ä½•ç±»å‹çš„å€¼ï¼Œä½†å¯¹äºå‡½æ•°æœ‰ç‰¹æ®Šçš„è¡Œä¸ºã€‚

    -   å¦‚æœä½ å°†å‡½æ•°ä½œä¸ºÂ `nextState`Â ä¼ é€’ï¼Œå®ƒå°†è¢«è§†ä¸ºÂ **æ›´æ–°å‡½æ•°**ã€‚å®ƒå¿…é¡»æ˜¯çº¯å‡½æ•°ï¼Œåªæ¥å—å¾…å®šçš„ state ä½œä¸ºå…¶å”¯ä¸€å‚æ•°ï¼Œå¹¶åº”è¿”å›ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚React å°†æŠŠä½ çš„æ›´æ–°å‡½æ•°æ”¾å…¥é˜Ÿåˆ—ä¸­å¹¶é‡æ–°æ¸²æŸ“ç»„ä»¶ã€‚åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“æœŸé—´ï¼ŒReact å°†é€šè¿‡æŠŠé˜Ÿåˆ—ä¸­æ‰€æœ‰æ›´æ–°å‡½æ•°åº”ç”¨äºå…ˆå‰çš„çŠ¶æ€æ¥è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚

###### è¿”å›å€¼Â [](https://zh-hans.react.dev/reference/react/useState#setstate-returns "Link for è¿”å›å€¼ ")

`set` å‡½æ•°æ²¡æœ‰è¿”å›å€¼ã€‚
### 4ã€æ³¨æ„äº‹é¡¹Â [](https://zh-hans.react.dev/reference/react/useState#setstate-caveats "Link for æ³¨æ„äº‹é¡¹ ")

-   `set` å‡½æ•° **ä»…æ›´æ–° *ä¸‹ä¸€æ¬¡* æ¸²æŸ“çš„çŠ¶æ€å˜é‡**ã€‚å¦‚æœåœ¨è°ƒç”¨ `set` å‡½æ•°åè¯»å–çŠ¶æ€å˜é‡ï¼Œåˆ™ [ä»ä¼šå¾—åˆ°åœ¨è°ƒç”¨ä¹‹å‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„æ—§å€¼](https://zh-hans.react.dev/reference/react/useState#ive-updated-the-state-but-logging-gives-me-the-old-value)ã€‚
-   å¦‚æœä½ æä¾›çš„æ–°å€¼ä¸å½“å‰ `state` ç›¸åŒï¼ˆç”± [`Object.is`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is) æ¯”è¾ƒç¡®å®šï¼‰ï¼ŒReact å°† **è·³è¿‡é‡æ–°æ¸²æŸ“è¯¥ç»„ä»¶åŠå…¶å­ç»„ä»¶**ã€‚è¿™æ˜¯ä¸€ç§ä¼˜åŒ–ã€‚è™½ç„¶åœ¨æŸäº›æƒ…å†µä¸‹ React ä»ç„¶éœ€è¦åœ¨è·³è¿‡å­ç»„ä»¶ä¹‹å‰è°ƒç”¨ä½ çš„ç»„ä»¶ï¼Œä½†è¿™ä¸åº”å½±å“ä½ çš„ä»£ç ã€‚
-   React ä¼š [æ‰¹é‡å¤„ç†çŠ¶æ€æ›´æ–°](https://zh-hans.react.dev/learn/queueing-a-series-of-state-updates)ã€‚å®ƒä¼šåœ¨æ‰€æœ‰ **äº‹ä»¶å¤„ç†å‡½æ•°è¿è¡Œ** å¹¶è°ƒç”¨å…¶ `set` å‡½æ•°åæ›´æ–°å±å¹•ã€‚è¿™å¯ä»¥é˜²æ­¢åœ¨å•ä¸ªäº‹ä»¶æœŸé—´å¤šæ¬¡é‡æ–°æ¸²æŸ“ã€‚åœ¨æŸäº›ç½•è§æƒ…å†µä¸‹ï¼Œä½ éœ€è¦å¼ºåˆ¶ React æ›´æ—©åœ°æ›´æ–°å±å¹•ï¼Œä¾‹å¦‚è®¿é—® DOMï¼Œä½ å¯ä»¥ä½¿ç”¨ [`flushSync`](https://zh-hans.react.dev/reference/react-dom/flushSync)ã€‚
-   `set` å‡½æ•°å…·æœ‰ç¨³å®šçš„æ ‡è¯†ï¼Œæ‰€ä»¥ä½ ç»å¸¸ä¼šçœ‹åˆ° Effect çš„ä¾èµ–æ•°ç»„ä¸­ä¼šçœç•¥å®ƒï¼Œå³ä½¿åŒ…å«å®ƒä¹Ÿä¸ä¼šå¯¼è‡´ Effect é‡æ–°è§¦å‘ã€‚å¦‚æœ linter å…è®¸ä½ çœç•¥ä¾èµ–é¡¹å¹¶ä¸”æ²¡æœ‰æŠ¥é”™ï¼Œé‚£ä¹ˆä½ å°±å¯ä»¥å®‰å…¨åœ°çœç•¥å®ƒã€‚
-   åœ¨æ¸²æŸ“æœŸé—´ï¼Œåªå…è®¸åœ¨å½“å‰æ¸²æŸ“ç»„ä»¶å†…éƒ¨è°ƒç”¨ `set` å‡½æ•°ã€‚React å°†ä¸¢å¼ƒå…¶è¾“å‡ºå¹¶ç«‹å³å°è¯•ä½¿ç”¨æ–°çŠ¶æ€é‡æ–°æ¸²æŸ“ã€‚è¿™ç§æ–¹å¼å¾ˆå°‘éœ€è¦ï¼Œä½†ä½ å¯ä»¥ä½¿ç”¨å®ƒæ¥å­˜å‚¨ **å…ˆå‰æ¸²æŸ“ä¸­çš„ä¿¡æ¯**ã€‚
-   åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ï¼ŒReact å°† **ä¸¤æ¬¡è°ƒç”¨ä½ çš„æ›´æ–°å‡½æ•°**ï¼Œä»¥å¸®åŠ©ä½ æ‰¾åˆ° [æ„å¤–çš„ä¸çº¯æ€§](https://zh-hans.react.dev/reference/react/useState#my-initializer-or-updater-function-runs-twice)ã€‚è¿™åªæ˜¯å¼€å‘æ—¶çš„è¡Œä¸ºï¼Œä¸å½±å“ç”Ÿäº§ã€‚å¦‚æœä½ çš„æ›´æ–°å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼ˆæœ¬è¯¥æ˜¯è¿™æ ·ï¼‰ï¼Œå°±ä¸åº”å½±å“è¯¥è¡Œä¸ºã€‚å…¶ä¸­ä¸€æ¬¡è°ƒç”¨çš„ç»“æœå°†è¢«å¿½ç•¥ã€‚

-   `useState`Â æ˜¯ä¸€ä¸ª Hookï¼Œå› æ­¤ä½ åªèƒ½åœ¨Â **ç»„ä»¶çš„é¡¶å±‚**Â æˆ–è‡ªå·±çš„ Hook ä¸­è°ƒç”¨å®ƒã€‚ä½ ä¸èƒ½åœ¨å¾ªç¯æˆ–æ¡ä»¶è¯­å¥ä¸­è°ƒç”¨å®ƒã€‚å¦‚æœä½ éœ€è¦è¿™æ ·åšï¼Œè¯·æå–ä¸€ä¸ªæ–°ç»„ä»¶å¹¶å°†çŠ¶æ€ç§»å…¥å…¶ä¸­ã€‚
- åœ¨ä¸¥æ ¼æ¨¡å¼ä¸­ï¼ŒReact å°†Â **ä¸¤æ¬¡è°ƒç”¨åˆå§‹åŒ–å‡½æ•°**ï¼Œä»¥Â [å¸®ä½ æ‰¾åˆ°æ„å¤–çš„ä¸çº¯æ€§](https://zh-hans.react.dev/reference/react/useState#my-initializer-or-updater-function-runs-twice)ã€‚è¿™åªæ˜¯å¼€å‘æ—¶çš„è¡Œä¸ºï¼Œä¸å½±å“ç”Ÿäº§ã€‚å¦‚æœä½ çš„åˆå§‹åŒ–å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼ˆæœ¬è¯¥æ˜¯è¿™æ ·ï¼‰ï¼Œå°±ä¸åº”å½±å“è¯¥è¡Œä¸ºã€‚å…¶ä¸­ä¸€ä¸ªè°ƒç”¨çš„ç»“æœå°†è¢«å¿½ç•¥ã€‚

# ä¸‰ã€å¸¸è§åœºæ™¯ä½¿ç”¨å‘ç‚¹

### æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ—¥å¿—ä»æ˜¾ç¤ºæ—§å€¼Â [](https://zh-hans.react.dev/reference/react/useState#ive-updated-the-state-but-logging-gives-me-the-old-value "Link for æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ—¥å¿—ä»æ˜¾ç¤ºæ—§å€¼ ")

è°ƒç”¨ `set` å‡½æ•° **ä¸èƒ½æ”¹å˜è¿è¡Œä¸­ä»£ç çš„çŠ¶æ€**ï¼š

```js
function handleClick() {

  console.log(count);  // 0



  setCount(count + 1); // è¯·æ±‚ä½¿ç”¨ 1 é‡æ–°æ¸²æŸ“

  console.log(count);  // ä»ç„¶æ˜¯ 0!



  setTimeout(() => {

    console.log(count); // è¿˜æ˜¯ 0!

  }, 5000);

}
```

è¿™æ˜¯å› ä¸º [çŠ¶æ€è¡¨ç°ä¸ºå°±åƒä¸€ä¸ªå¿«ç…§](https://zh-hans.react.dev/learn/state-as-a-snapshot)ã€‚æ›´æ–°çŠ¶æ€ä¼šä½¿ç”¨æ–°çš„çŠ¶æ€å€¼è¯·æ±‚å¦ä¸€ä¸ªæ¸²æŸ“ï¼Œä½†å¹¶ä¸å½±å“åœ¨ä½ å·²ç»è¿è¡Œçš„äº‹ä»¶å¤„ç†å‡½æ•°ä¸­çš„ `count` JavaScript å˜é‡ã€‚

å¦‚æœä½ éœ€è¦ä½¿ç”¨ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨å°†å…¶ä¼ é€’ç»™ `set` å‡½æ•°ä¹‹å‰å°†å…¶ä¿å­˜åœ¨ä¸€ä¸ªå˜é‡ä¸­ï¼š

```js
const nextCount = count + 1;

setCount(nextCount);



console.log(count);     // 0

console.log(nextCount); // 1
```
### æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ˜¯å±å¹•æ²¡æœ‰æ›´æ–°Â [](https://zh-hans.react.dev/reference/react/useState#ive-updated-the-state-but-the-screen-doesnt-update "Link for æˆ‘å·²ç»æ›´æ–°äº†çŠ¶æ€ï¼Œä½†æ˜¯å±å¹•æ²¡æœ‰æ›´æ–° ")

**å¦‚æœä¸‹ä¸€ä¸ªçŠ¶æ€ç­‰äºå…ˆå‰çš„çŠ¶æ€ï¼ŒReact å°†å¿½ç•¥ä½ çš„æ›´æ–°**ï¼Œè¿™æ˜¯ç”± [`Object.is`](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/is) æ¯”è¾ƒç¡®å®šçš„ã€‚è¿™é€šå¸¸å‘ç”Ÿåœ¨ä½ ç›´æ¥æ›´æ”¹çŠ¶æ€ä¸­çš„å¯¹è±¡æˆ–æ•°ç»„æ—¶ï¼š

```js
obj.x = 10;  // ğŸš© é”™è¯¯ï¼šç›´æ¥ä¿®æ”¹ç°æœ‰çš„å¯¹è±¡

setObj(obj); // ğŸš© ä¸ä¼šå‘ç”Ÿä»»ä½•äº‹æƒ…
```

ä½ ä¿®æ”¹äº†ä¸€ä¸ªç°æœ‰çš„ `obj` å¯¹è±¡å¹¶å°†å…¶ä¼ é€’å› `setObj`ï¼Œå› æ­¤ React å¿½ç•¥äº†æ›´æ–°ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ éœ€è¦ç¡®ä¿å§‹ç»ˆ[åœ¨çŠ¶æ€ä¸­ **æ›¿æ¢** å¯¹è±¡å’Œæ•°ç»„ï¼Œè€Œä¸æ˜¯å¯¹å®ƒä»¬è¿›è¡Œ **æ›´æ”¹**](https://zh-hans.react.dev/reference/react/useState#updating-objects-and-arrays-in-state)ï¼š

```js
// âœ… æ­£ç¡®ï¼šåˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡

setObj({

  ...obj,

  x: 10

});
```
### å‡ºç°é”™è¯¯ï¼šâ€œToo many re-rendersâ€Â [](https://zh-hans.react.dev/reference/react/useState#im-getting-an-error-too-many-re-renders "Link for å‡ºç°é”™è¯¯ï¼šâ€œToo many re-rendersâ€ ")

æœ‰æ—¶å¯èƒ½ä¼šå‡ºç°é”™è¯¯ï¼šâ€œToo many re-rendersâ€ã€‚React ä¼šé™åˆ¶æ¸²æŸ“æ¬¡æ•°ï¼Œä»¥é˜²æ­¢è¿›å…¥æ— é™å¾ªç¯ã€‚é€šå¸¸ï¼Œè¿™æ„å‘³ç€ **åœ¨æ¸²æŸ“æœŸé—´** æ— æ¡ä»¶åœ°è®¾ç½®çŠ¶æ€ï¼Œå› æ­¤ç»„ä»¶è¿›å…¥å¾ªç¯ï¼šæ¸²æŸ“ã€è®¾ç½®çŠ¶æ€ï¼ˆå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼‰ã€æ¸²æŸ“ã€è®¾ç½®çŠ¶æ€ï¼ˆå¯¼è‡´é‡æ–°æ¸²æŸ“ï¼‰ç­‰ç­‰ã€‚é€šå¸¸ï¼Œè¿™æ˜¯ç”±é”™è¯¯åœ°æŒ‡å®šäº‹ä»¶å¤„ç†å‡½æ•°æ—¶å¼•èµ·çš„ï¼š

```js
// ğŸš© é”™è¯¯ï¼šåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­è°ƒç”¨äº‹ä»¶å¤„ç†å‡½æ•°

return <button onClick={handleClick()}>Click me</button>



// âœ… æ­£ç¡®ï¼šå°†äº‹ä»¶å¤„ç†å‡½æ•°ä¼ é€’ä¸‹å»

return <button onClick={handleClick}>Click me</button>



// âœ… æ­£ç¡®ï¼šä¼ é€’ä¸€ä¸ªå†…è”å‡½æ•°

return <button onClick={(e) => handleClick(e)}>Click me</button>
```

å¦‚æœæ‰¾ä¸åˆ°è¿™ä¸ªé”™è¯¯çš„åŸå› ï¼Œè¯·å•å‡»æ§åˆ¶å°ä¸­é”™è¯¯æ—è¾¹çš„ç®­å¤´ï¼ŒæŸ¥çœ‹ JavaScript å †æ ˆä»¥æ‰¾åˆ°å¯¼è‡´é”™è¯¯çš„å…·ä½“ `set` å‡½æ•°è°ƒç”¨ã€‚
### åˆå§‹åŒ–å‡½æ•°æˆ–æ›´æ–°å‡½æ•°è¿è¡Œäº†ä¸¤æ¬¡Â [](https://zh-hans.react.dev/reference/react/useState#my-initializer-or-updater-function-runs-twice "Link for åˆå§‹åŒ–å‡½æ•°æˆ–æ›´æ–°å‡½æ•°è¿è¡Œäº†ä¸¤æ¬¡ ")

åœ¨ [ä¸¥æ ¼æ¨¡å¼](https://zh-hans.react.dev/reference/react/StrictMode) ä¸‹ï¼ŒReact ä¼šè°ƒç”¨ä½ çš„æŸäº›å‡½æ•°ä¸¤æ¬¡è€Œä¸æ˜¯ä¸€æ¬¡ï¼š

```js
function TodoList() {

  // è¯¥å‡½æ•°ç»„ä»¶ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“è¿è¡Œä¸¤æ¬¡ã€‚



  const [todos, setTodos] = useState(() => {

    // è¯¥åˆå§‹åŒ–å‡½æ•°åœ¨åˆå§‹åŒ–æœŸé—´ä¼šè¿è¡Œä¸¤æ¬¡ã€‚

    return createTodos();

  });



  function handleClick() {

    setTodos(prevTodos => {

      // è¯¥æ›´æ–°å‡½æ•°åœ¨æ¯æ¬¡ç‚¹å‡»ä¸­éƒ½ä¼šè¿è¡Œä¸¤æ¬¡

      return [...prevTodos, createTodo()];

    });

  }

  // ...
```

è¿™æ˜¯æ‰€æœŸæœ›çš„ï¼Œä¸”ä¸åº”è¯¥ç ´åä½ çš„ä»£ç ã€‚

è¿™ç§ **ä»…åœ¨å¼€å‘ç¯å¢ƒä¸‹ç”Ÿæ•ˆ** çš„è¡Œä¸ºæœ‰åŠ©äº [ä¿æŒç»„ä»¶çš„çº¯ç²¹æ€§](https://zh-hans.react.dev/learn/keeping-components-pure)ã€‚React ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªè°ƒç”¨çš„ç»“æœï¼Œè€Œå¿½ç•¥å¦ä¸€ä¸ªè°ƒç”¨çš„ç»“æœã€‚åªè¦ä½ çš„ç»„ä»¶ã€åˆå§‹åŒ–å‡½æ•°å’Œæ›´æ–°å‡½æ•°æ˜¯çº¯ç²¹çš„ï¼Œå°±ä¸ä¼šå½±å“ä½ çš„é€»è¾‘ã€‚ä½†æ˜¯ï¼Œå¦‚æœå®ƒä»¬æ„å¤–åœ°ä¸çº¯ç²¹ï¼Œè¿™å°†å¸®åŠ©ä½ æ³¨æ„åˆ°é”™è¯¯ã€‚

ä¾‹å¦‚ï¼Œè¿™ä¸ªä¸çº¯çš„æ›´æ–°å‡½æ•°æ”¹å˜äº† state ä¸­çš„ä¸€ä¸ªæ•°ç»„ï¼š

```js
setTodos(prevTodos => {

  // ğŸš© é”™è¯¯ï¼šæ”¹å˜ state

  prevTodos.push(createTodo());

});
```

å› ä¸º React è°ƒç”¨äº†ä¸¤æ¬¡æ›´æ–°å‡½æ•°ï¼Œæ‰€ä»¥ä½ å°†çœ‹åˆ° todo è¢«æ·»åŠ äº†ä¸¤æ¬¡ï¼Œæ‰€ä»¥ä½ å°†çŸ¥é“å‡ºç°äº†é”™è¯¯ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä½ å¯ä»¥é€šè¿‡ [æ›¿æ¢æ•°ç»„è€Œä¸æ˜¯æ›´æ”¹æ•°ç»„](https://zh-hans.react.dev/reference/react/useState#updating-objects-and-arrays-in-state) æ¥ä¿®å¤è¿™ä¸ªé”™è¯¯ï¼š

```js
setTodos(prevTodos => {

  // âœ… æ­£ç¡®ï¼šä½¿ç”¨æ–°çŠ¶æ€æ›¿æ¢

  return [...prevTodos, createTodo()];

});
```

ç°åœ¨ï¼Œè¿™ä¸ªæ›´æ–°å‡½æ•°æ˜¯çº¯ç²¹çš„ï¼Œæ‰€ä»¥å¤šè°ƒç”¨ä¸€æ¬¡ä¸ä¼šå¯¹è¡Œä¸ºäº§ç”Ÿå½±å“ã€‚è¿™å°±æ˜¯ React è°ƒç”¨å®ƒä¸¤æ¬¡å¯ä»¥å¸®åŠ©ä½ æ‰¾åˆ°é”™è¯¯çš„åŸå› ã€‚**åªæœ‰ç»„ä»¶ã€åˆå§‹åŒ–å‡½æ•°å’Œæ›´æ–°å‡½æ•°éœ€è¦æ˜¯çº¯ç²¹çš„**ã€‚äº‹ä»¶å¤„ç†å‡½æ•°ä¸éœ€è¦æ˜¯çº¯ç²¹çš„ï¼Œæ‰€ä»¥ React ä¸ä¼šä¸¤æ¬¡è°ƒç”¨ä½ çš„äº‹ä»¶å¤„ç†å‡½æ•°ã€‚

é˜…è¯» [ä¿æŒç»„ä»¶çº¯ç²¹](https://zh-hans.react.dev/learn/keeping-components-pure) ä»¥äº†è§£æ›´å¤šä¿¡æ¯ã€‚

* * *

### æˆ‘å°è¯•å°† state è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä½†å®ƒå´è¢«è°ƒç”¨äº†Â [](https://zh-hans.react.dev/reference/react/useState#im-trying-to-set-state-to-a-function-but-it-gets-called-instead "Link for æˆ‘å°è¯•å°† state è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°ï¼Œä½†å®ƒå´è¢«è°ƒç”¨äº† ")

ä½ ä¸èƒ½åƒè¿™æ ·æŠŠå‡½æ•°æ”¾å…¥çŠ¶æ€ï¼š

```js
const [fn, setFn] = useState(someFunction);



function handleClick() {

  setFn(someOtherFunction);

}
```

å› ä¸ºä½ ä¼ é€’äº†ä¸€ä¸ªå‡½æ•°ï¼ŒReact è®¤ä¸º `someFunction` æ˜¯ä¸€ä¸ª [åˆå§‹åŒ–å‡½æ•°](https://zh-hans.react.dev/reference/react/useState#avoiding-recreating-the-initial-state)ï¼Œè€Œ `someOtherFunction` æ˜¯ä¸€ä¸ª [æ›´æ–°å‡½æ•°](https://zh-hans.react.dev/reference/react/useState#updating-state-based-on-the-previous-state)ï¼Œäºæ˜¯å®ƒå°è¯•è°ƒç”¨å®ƒä»¬å¹¶å­˜å‚¨ç»“æœã€‚è¦å®é™… **å­˜å‚¨** ä¸€ä¸ªå‡½æ•°ï¼Œä½ å¿…é¡»åœ¨ä¸¤ç§æƒ…å†µä¸‹åœ¨å®ƒä»¬ä¹‹å‰åŠ ä¸Š `() =>`ã€‚ç„¶å React å°†å­˜å‚¨ä½ ä¼ é€’çš„å‡½æ•°ã€‚

```js
const [fn, setFn] = useState(() => someFunction);



function handleClick() {

  setFn(() => someOtherFunction);

}
```